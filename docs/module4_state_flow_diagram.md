# Module 4: Date & Duration Selection - State Flow Diagram

## Visual State Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    RentalDurationScreen                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  [Day-Wise Rental]    [Hourly Rental]    â† Tab Switcher â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€ DAY-WISE RENTAL â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                                                             â”‚  â”‚
â”‚  â”‚  State 1: BLANK (Figma 1:19873)                           â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚  â”‚
â”‚  â”‚  â”‚  September 2025                            â”‚           â”‚  â”‚
â”‚  â”‚  â”‚  [ ] [ ] [ ] [ ] [ ] [ ] [ ]  â† All dates â”‚           â”‚  â”‚
â”‚  â”‚  â”‚  [ ] [ ] [ ] [ ] [ ] [ ] [ ]    selectableâ”‚           â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚  â”‚
â”‚  â”‚  [Apply - DISABLED â­•]                                    â”‚  â”‚
â”‚  â”‚                                                             â”‚  â”‚
â”‚  â”‚              â†“ (User taps Sept 20)                        â”‚  â”‚
â”‚  â”‚                                                             â”‚  â”‚
â”‚  â”‚  State 2: FIRST DAY SELECTED (Figma 1:18995)             â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚  â”‚
â”‚  â”‚  â”‚  September 2025                            â”‚           â”‚  â”‚
â”‚  â”‚  â”‚  [ ] [ ] [ ] [ğŸŸ£] [ ] [ ] [ ] â† Sept 20   â”‚           â”‚  â”‚
â”‚  â”‚  â”‚  [ ] [ ] [ ] [ ] [ ] [ ] [ ]    highlightedâ”‚           â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚  â”‚
â”‚  â”‚  [Apply - DISABLED â­•]                                    â”‚  â”‚
â”‚  â”‚                                                             â”‚  â”‚
â”‚  â”‚              â†“ (User taps Sept 26)                        â”‚  â”‚
â”‚  â”‚                                                             â”‚  â”‚
â”‚  â”‚  State 3: LAST DAY SELECTED (Figma 1:19651)              â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚  â”‚
â”‚  â”‚  â”‚  September 2025                            â”‚           â”‚  â”‚
â”‚  â”‚  â”‚  [ ] [ ] [ ] [ğŸŸ£] [ ] [ ] [ ] â† Sept 20   â”‚           â”‚  â”‚
â”‚  â”‚  â”‚  [ ] [ ] [ ] [ğŸŸª][ğŸŸª][ğŸŸª][ğŸŸ£] â† Sept 26   â”‚           â”‚  â”‚
â”‚  â”‚  â”‚       Range: Sept 20-26 (7 days)           â”‚           â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚  â”‚
â”‚  â”‚  [Apply - ENABLED âœ…]                                     â”‚  â”‚
â”‚  â”‚                                                             â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€ HOURLY RENTAL â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                                                             â”‚  â”‚
â”‚  â”‚  State 1: BLANK (Figma 1:19540)                           â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚  â”‚
â”‚  â”‚  â”‚  ğŸ“… On date: 11 Sep 2025  [Change]        â”‚           â”‚  â”‚
â”‚  â”‚  â”‚                                             â”‚           â”‚  â”‚
â”‚  â”‚  â”‚  [12:00] [01:00] [02:00] [03:00] ...      â”‚           â”‚  â”‚
â”‚  â”‚  â”‚  [06:00] [07:00] [08:00] [09:00] ...      â”‚           â”‚  â”‚
â”‚  â”‚  â”‚         â† All time slots selectable        â”‚           â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚  â”‚
â”‚  â”‚  [Apply - DISABLED â­•]                                    â”‚  â”‚
â”‚  â”‚                                                             â”‚  â”‚
â”‚  â”‚              â†“ (User taps 08:00)                          â”‚  â”‚
â”‚  â”‚                                                             â”‚  â”‚
â”‚  â”‚  State 2: START HOUR SELECTED (Figma 1:19215)            â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚  â”‚
â”‚  â”‚  â”‚  ğŸ“… On date: 11 Sep 2025  [Change]        â”‚           â”‚  â”‚
â”‚  â”‚  â”‚                                             â”‚           â”‚  â”‚
â”‚  â”‚  â”‚  [12:00] [01:00] [02:00] [03:00] ...      â”‚           â”‚  â”‚
â”‚  â”‚  â”‚  [06:00] [07:00] [ğŸŸ£08:00] [09:00] ...    â”‚           â”‚  â”‚
â”‚  â”‚  â”‚                   â†‘ highlighted             â”‚           â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚  â”‚
â”‚  â”‚  [Apply - DISABLED â­•]                                    â”‚  â”‚
â”‚  â”‚                                                             â”‚  â”‚
â”‚  â”‚              â†“ (User taps 03:00 PM)                       â”‚  â”‚
â”‚  â”‚                                                             â”‚  â”‚
â”‚  â”‚  State 3: END HOUR SELECTED (Figma 1:19427)              â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚  â”‚
â”‚  â”‚  â”‚  ğŸ“… On date: 11 Sep 2025  [Change]        â”‚           â”‚  â”‚
â”‚  â”‚  â”‚                                             â”‚           â”‚  â”‚
â”‚  â”‚  â”‚  [12:00] [ğŸŸª01:00] [ğŸŸª02:00] [ğŸŸ£03:00]    â”‚           â”‚  â”‚
â”‚  â”‚  â”‚  [06:00] [07:00] [ğŸŸ£08:00] [ğŸŸª09:00]      â”‚           â”‚  â”‚
â”‚  â”‚  â”‚       Range: 08:00 - 03:00 (7 hours)       â”‚           â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚  â”‚
â”‚  â”‚  [Apply - ENABLED âœ…]                                     â”‚  â”‚
â”‚  â”‚                                                             â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Legend:
  ğŸŸ£ = Selected (Purple #7132F4)
  ğŸŸª = In Range (Light Purple #EBEFF5)
  [ ] = Available (White)
  â­• = Disabled (Gray #EBEBEB)
  âœ… = Enabled (Purple #7132F4)
```

---

## Date Selection Drawer (Modal)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Select Date                       âœ•   â”‚  â† Header
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                        â”‚
â”‚    â—€  September 2025  â–¶               â”‚  â† Month Navigation
â”‚                                        â”‚
â”‚    [ ] [ ] [ ] [ ] [ ] [ ] [ ]        â”‚
â”‚    [ ] [ ] [ ] [ ] [ ] [ ] [ ]        â”‚
â”‚    [ ] [ ] [ ] [ğŸŸ£] [ ] [ ] [ ]       â”‚  â† Sept 11 selected
â”‚    [ ] [ ] [ ] [ ] [ ] [ ] [ ]        â”‚
â”‚    [ ] [ ] [ ] [ ] [ ] [ ]            â”‚
â”‚                                        â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚    â”‚  Set Date  â–¶                 â”‚   â”‚  â† Confirm Button
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Controller State Machine

```
RentalDurationController
  â”‚
  â”œâ”€ rentalType: Rx<RentalType>
  â”‚   â””â”€ Values: dayWise | hourly
  â”‚
  â”œâ”€ Day-Wise State
  â”‚   â”œâ”€ startDate: Rxn<DateTime>
  â”‚   â”œâ”€ endDate: Rxn<DateTime>
  â”‚   â””â”€ totalDays: int? (computed)
  â”‚
  â”œâ”€ Hourly State
  â”‚   â”œâ”€ rentalDate: Rxn<DateTime>
  â”‚   â”œâ”€ startHour: Rxn<String>
  â”‚   â”œâ”€ endHour: Rxn<String>
  â”‚   â””â”€ totalHours: int? (computed)
  â”‚
  â”œâ”€ Calendar State
  â”‚   â””â”€ currentMonth: Rx<DateTime>
  â”‚
  â””â”€ Computed Properties
      â”œâ”€ canApply: bool
      â”œâ”€ isDateSelected(date): bool
      â”œâ”€ isDateInRange(date): bool
      â”œâ”€ isTimeSelected(time): bool
      â””â”€ isTimeInRange(time): bool
```

---

## User Journey Flow

```
Vehicle Detail Screen
        â†“
        â†“ (User taps "Select Dates")
        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  RentalDurationScreen     â”‚
â”‚  (Tab: Day-Wise)          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â†“
        â†“ (User selects date range)
        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  [Apply] button enabled   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â†“
        â†“ (User taps Apply)
        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Returns to caller with:  â”‚
â”‚  - type: dayWise          â”‚
â”‚  - startDate: Sept 20     â”‚
â”‚  - endDate: Sept 26       â”‚
â”‚  - totalDays: 7           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â†“
        â†“
Add-Ons / Pickup Location Screen
```

---

## Widget Tree Structure

```
RentalDurationScreen (Scaffold)
  â”‚
  â”œâ”€ AppBar
  â”‚   â”œâ”€ Back Button (IconButton)
  â”‚   â”œâ”€ Title ("Rent Vehicle")
  â”‚   â””â”€ Close Button (Image.asset)
  â”‚
  â”œâ”€ Body (Column)
  â”‚   â”‚
  â”‚   â”œâ”€ Tab Selector (Row)
  â”‚   â”‚   â”œâ”€ _TabButton (Day-Wise)
  â”‚   â”‚   â””â”€ _TabButton (Hourly)
  â”‚   â”‚
  â”‚   â”œâ”€ Content Area (Obx â†’ dynamic)
  â”‚   â”‚   â”‚
  â”‚   â”‚   â”œâ”€ IF Day-Wise:
  â”‚   â”‚   â”‚   â””â”€ DayWiseRentalSelector
  â”‚   â”‚   â”‚       â”œâ”€ Weekday Headers
  â”‚   â”‚   â”‚       â””â”€ Calendar Months
  â”‚   â”‚   â”‚           â”œâ”€ Month 1 Grid
  â”‚   â”‚   â”‚           â””â”€ Month 2 Grid
  â”‚   â”‚   â”‚
  â”‚   â”‚   â””â”€ IF Hourly:
  â”‚   â”‚       â””â”€ HourlyRentalSelector
  â”‚   â”‚           â”œâ”€ Date Selector Card
  â”‚   â”‚           â”œâ”€ AM Time Grid
  â”‚   â”‚           â””â”€ PM Time Grid
  â”‚   â”‚
  â”‚   â””â”€ Apply Button (ElevatedButton)
  â”‚       â””â”€ Obx â†’ canApply ? enabled : disabled
  â”‚
  â””â”€ (Modal) DateSelectionDrawer
      â”œâ”€ Header (Select Date + Close)
      â”œâ”€ Month Navigation
      â”œâ”€ Calendar Grid
      â””â”€ Set Date Button
```

---

## File Dependency Graph

```
rental_duration_screen.dart
  â”‚
  â”œâ”€ imports: rental_duration_controller.dart
  â”œâ”€ imports: day_wise_rental_selector.dart
  â””â”€ imports: hourly_rental_selector.dart
         â”‚
         â””â”€ imports: date_selection_drawer.dart

rental_duration_controller.dart
  â”‚
  â””â”€ imports: get (GetX)

All widgets
  â”‚
  â””â”€ imports: intl (Date formatting)
```

---

## Color States Reference

| Element | Default | Selected | In Range | Disabled |
|---------|---------|----------|----------|----------|
| **Calendar Date** | White bg<br>Black text | Purple bg #7132F4<br>White text | Light purple bg #EBEFF5<br>Purple text | White bg<br>Gray text 40% |
| **Time Slot** | White bg<br>Black text<br>Gray border | Purple bg #7132F4<br>White text<br>Purple border | Light purple bg #EBEFF5<br>Purple text<br>Purple border | N/A |
| **Apply Button** | Gray bg #EBEBEB<br>White text | Purple bg #7132F4<br>White text | N/A | Gray bg #EBEBEB<br>White text |
| **Tab Button** | White bg<br>Black text<br>Gray border | Light bg #EBEFF5<br>Purple text #7132F4<br>Purple border | N/A | N/A |

---

This visual guide provides a complete overview of how the date & duration selection feature works, how states transition, and how the widgets are structured.

